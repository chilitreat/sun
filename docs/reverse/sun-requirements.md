# Sun 要件定義書（逆生成）

## 分析概要

**分析日時**: 2025 年 8 月 3 日  
**対象コードベース**: /Users/shirata/dev/sun  
**抽出要件数**: 6 個の機能要件、2 個のデータ要件  
**信頼度**: 高

## システム概要

### 推定されたシステム目的

記事の管理とナビゲーションを提供し、ユーザーが効率的にコンテンツを探索できるようにする。

### 対象ユーザー

- 記事を閲覧する一般ユーザー
- 記事を作成・管理するコンテンツ管理者

## ユーザーストーリー

### ストーリー 1: 記事ナビゲーション

- **である** 記事を閲覧するユーザー **として**
- **私は** 前後の記事を簡単に移動 **したい**
- **そうすることで** 関連するコンテンツを効率的に探索できる

**実装根拠**:

- `ArticleNavigation.tsx` - ナビゲーションコンポーネント

### ストーリー 2: ハッシュタグ管理

- **である** 記事を作成するコンテンツ管理者 **として**
- **私は** ハッシュタグを正規化して管理 **したい**
- **そうすることで** 記事の分類と検索を容易にする

**実装根拠**:

- `hashtags.ts` - ハッシュタグユーティリティ関数

## 機能要件（EARS 記法）

### 通常要件

#### REQ-001: 記事間ナビゲーション

システムは前後の記事へのリンクを表示しなければならない。

**実装根拠**:

- `ArticleNavigation.tsx`コンポーネント
- `previousPost`および`nextPost`プロパティ

#### REQ-002: ナビゲーションの非表示

システムは前後の記事が存在しない場合、ナビゲーションを表示してはならない。

**実装根拠**:

- `if (!previousPost && !nextPost)`条件分岐

#### REQ-201: ハッシュタグの正規化

システムはハッシュタグを小文字に変換し、特殊文字を削除しなければならない。

**実装根拠**:

- `normalizeHashtag`関数
- テストケース: 小文字変換、特殊文字削除、空白トリム

#### REQ-202: ハッシュタグの解析

システムはハッシュタグを文字列または配列から解析し、標準化されたリストを生成しなければならない。

**実装根拠**:

- `parseHashtags`関数
- テストケース: undefined、空文字、配列入力の処理

### データ要件

#### REQ-101: 記事データ管理

システムは記事のタイトル、内容、作成日時を保存しなければならない。

**実装根拠**:

- `articles`テーブル
- `title`、`content`、`created_at`カラム

#### REQ-102: 作成日時のインデックス

システムは作成日時に基づいて記事を効率的に検索できなければならない。

**実装根拠**:

- `idx_articles_created_at`インデックス

## 推奨追加テスト

- [ ] **パフォーマンステスト**
  - [ ] 記事ナビゲーションの応答時間測定
  - [ ] ハッシュタグ解析の負荷テスト
- [ ] **セキュリティテスト**
  - [ ] SQL インジェクション対策テスト
  - [ ] XSS 対策テスト
- [ ] **アクセシビリティテスト**
  - [ ] ナビゲーションのキーボード操作テスト

## 分析の制約事項

- **コメント不足**: 開発者の意図を推定で補完
- **テストカバレッジ**: 一部の機能は未テスト
- **ドキュメント不足**: 外部仕様書が存在しない
